<!DOCTYPE html><html lang=zh><head><meta charset=UTF-8><title>水印助手</title><meta content="width=device-width,initial-scale=1" name=viewport><style>body{margin:auto;max-width:60vh}img{border:0;border-radius:5px;width:100%;box-sizing:border-box}canvas{width:0;height:0}label{display:flex;align-items:center;margin-top:8px}#drop-area{border:2px dashed #ccc;padding:10px;text-align:center}#upload-input{display:none}</style></head><body><canvas></canvas><a download id=imglink><img></a><div><div id=drop-area><input id=upload-input type=file accept=image/*> 拖放或点击选择图片</div><label>水印文字： <input id=content type=text value=仅供XX实名认证使用></label><label>水印颜色： <input id=color type=color value=#666666></label><label>图片宽度： <input id=width type=number value=2048></label><label>图片质量： <input id=quality type=range value=80 max=100 min=1><span id=imgsize></span></label><label>不透明度： <input id=alpha type=range value=20 max=100 min=10></label><label>文字大小： <input id=size type=range value=4 max=10 min=1></label><label>旋转角度： <input id=angle type=range value=-45 max=180 min=-180></label><label>水印行距： <input id=gap type=range value=150 max=300 min=20></label><label>水印字体： <input id=font type=text value=sans-serif></label><label><a download id=savelink href="javascript:alert('请先打开图片')">保存图片</a></label></div><script>var img=null;function repaint(){if(img){var e=document.getElementsByTagName("canvas")[0].getContext("2d"),t=document.getElementById("width").value,n=img.height*t/img.width,a=(e.canvas.width=t,e.canvas.height=n,Math.max(n,t)),d=(e.restore(),e.drawImage(img,0,0,t,n),e.fillStyle=document.getElementById("color").value,e.globalAlpha=document.getElementById("alpha").value/100,document.getElementById("size").value*a/100),l=(e.font=d+'px "'+document.getElementById("font").value+'"',e.textBaseline="middle",e.rotate(document.getElementById("angle").value*Math.PI/180),d*document.getElementById("gap").value/100),o=document.getElementById("content").value;if(o.length){for(var r=Math.sqrt(a*a*2),i=e.measureText(o).width,m=-a,c=!1;m<=r;m+=d+l,c=!c)for(var g=-a-(c?i/2:0);g<=r+(c?i/2:0);g+=i+d)e.fillText(o,g,m);t=document.getElementById("quality").value;e.canvas.toBlob(e=>{var t=URL.createObjectURL(e);document.getElementById("imgsize").innerHTML=`(${Math.ceil(e.size/1024)} KB)`,document.getElementsByTagName("img")[0].src=t,document.getElementById("imglink").href=t,document.getElementById("savelink").href=t},"image/jpeg",t/100)}}}function createBitmap(e,t){var n=document.createElement("img");n.addEventListener("load",function(){t(this)}),n.src=URL.createObjectURL(e)}function handleImageUpload(e){createBitmap(e,function(e){img=e,repaint()});e=e.name.split(".");e.splice(-1,0,"watermarked"),document.getElementById("imglink").download=e.join("."),document.getElementById("savelink").download=e.join(".")}document.addEventListener("change",function(e){"file"===e.target.type?e.target.files.length&&handleImageUpload(e.target.files[0]):repaint()});var dropArea=document.getElementById("drop-area");dropArea.addEventListener("dragover",function(e){e.preventDefault(),dropArea.style.backgroundColor="#f2f2f2"}),dropArea.addEventListener("dragleave",function(e){e.preventDefault(),dropArea.style.backgroundColor=""}),dropArea.addEventListener("drop",function(e){e.preventDefault(),dropArea.style.backgroundColor="",handleImageUpload(e.dataTransfer.files[0])}),dropArea.addEventListener("click",function(){document.getElementById("upload-input").click()})</script></body></html>